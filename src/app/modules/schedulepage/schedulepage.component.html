<div class="full-content">
  <div style="margin-bottom: 20px">
    <div class="assesment-header">
      <p class="assessment-text">Schedules</p>
    </div>

    <div class="flex breadDate">
      <div>
        <p-breadcrumb
          class="max-w-full BreadCrumb"
          [model]="items"
          [home]="home"
          [style]="{ border: 'none' }"
        ></p-breadcrumb>
      </div>
      <div class="date">
        {{ todayDate }}
      </div>
    </div>
  </div>

  <div class="scheduleTable">
    <!-- <div style="margin-top: 50px"> -->
    <!-- <div > -->
    <p-table
      #dt2
      dataKey="id"
      [tableStyle]="{ height: 'max-content' }"
      [value]="Tdata"
      dataKey="id"
      [(selection)]="selectedDeleteSchedule"
      [rows]="5"
      [showCurrentPageReport]="true"
      [rowsPerPageOptions]="[5, 10, 25, 50]"
      [loading]=""
      [paginator]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [globalFilterFields]="['JobDescription', 'Managername', 'Skill']"
    >
      <ng-template pTemplate="header">
        <tr>
          <th colspan="8">
            <div class="filter-components">
              <div class="first-four">
                <span class="p-input-icon-right searchIcon">
                  <input
                    pInputText
                    type="text"
                    placeholder="Search"
                    [(ngModel)]="globalSearchValue"
                    (input)="
                      dt2.filterGlobal($any($event.target).value, 'contains')
                    "
                  />

                  <i class="pi pi-search"></i>
                </span>
                <div class="managerMultiselect">
                  <p-columnFilter
                    field="Managername"
                    matchMode="in"
                    [showMenu]="false"
                    [showClearButton]="false"
                  >
                    <ng-template
                      pTemplate="filter"
                      let-value
                      let-filter="filterCallback"
                    >
                      <p-multiSelect
                        [ngModel]="value"
                        [options]="managerData"
                        placeholder="Manager"
                        (onChange)="filter($event.value)"
                        appendTo="body"
                      >
                        <ng-template let-option pTemplate="item">
                          <div class="inline-block vertical-align-middle">
                            <span class="ml-1 mt-1">{{ option }}</span>
                          </div>
                        </ng-template>
                      </p-multiSelect>
                    </ng-template>
                  </p-columnFilter>
                </div>

                <div class="skillMultiselect">
                  <p-columnFilter
                    field="Skill"
                    matchMode="contains"
                    [showMenu]="false"
                    [showClearButton]="false"
                  >
                    <ng-template
                      pTemplate="filter"
                      let-value
                      let-filter="filterCallback"
                    >
                      <p-multiSelect
                        [ngModel]="value"
                        [options]="skillSet"
                        placeholder="Skills"
                        (onChange)="filter($event.value)"
                        appendTo="body"
                      >
                        <ng-template let-option pTemplate="item">
                          <div class="inline-block vertical-align-middle">
                            <span class="ml-1 mt-1">{{ option }}</span>
                          </div>
                        </ng-template>
                      </p-multiSelect>
                    </ng-template>
                  </p-columnFilter>
                </div>
                <div class="ml-3 custom-clear">
                  <button
                    pButton
                    class="clear-button cursor-pointer"
                    (click)="onClearClick(dt2)"
                    [style]="{ width: '130px' }"
                    label="Clear Filter"
                  ></button>
                </div>
              </div>

              <div class="addDeletebutton">
                <div class="card flex justify-content-centre newscheduleButton">
                  <button
                    pButton
                    class="btn flex align-items-center justify-content-center cursor-pointer"
                    (click)="newSchedule()"
                    label="New Schedule"
                  ></button>
                </div>

                <div class="card flex justify-content-centre newscheduleButton">
                  <button
                    pButton
                    [disabled]="
                      !selectedDeleteSchedule ||
                      selectedDeleteSchedule.length == 0
                    "
                    class="btn flex align-items-center justify-content-center cursor-pointer"
                    (click)="deleteSchedule()"
                    label="Delete"
                  ></button>
                </div>
              </div>
            </div>
          </th>
        </tr>

        <tr>
          <th style="width: 4rem">
            <p-tableHeaderCheckbox
              [value]="Tdata"
              (click)="selectAll()"
            ></p-tableHeaderCheckbox>
          </th>
          <th class="schedulenameHeading">Schedule Name</th>
          <th class="managernameHeading">Manager</th>
          <th class="skillsHeading">Skills</th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-i="rowIndex">
        <tr>
          <td>
            <p-tableCheckbox
              [value]="rowData"
              [checked]="rowData.selection"
              (click)="toggleSelection(rowData)"
            ></p-tableCheckbox>
          </td>

          <td class="jobDescription">
            <!-- <img src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png" [class]="'flag flag-' + customer.country.code" style="width: 20px" /> -->
            <span class="ml-1 vertical-align-middle">{{
              rowData.JobDescription
            }}</span>
          </td>
          <td>
            <!-- <img [alt]="customer.representative.name" src="https://primefaces.org/cdn/primeng/images/demo/avatar/{{ customer.representative.image }}" width="32" style="vertical-align: middle" /> -->
            <span class="ml-1 vertical-align-middle">{{
              rowData.Managername
            }}</span>
          </td>
          <td class="skills">
            <span *ngFor="let item of getFormattedSkills(rowData.Skill).skills">
              <p-chip class="scheduleChip" label="{{ item }}"></p-chip>
            </span>
            <span
              *ngIf="getFormattedSkills(rowData.Skill).remainingCount > 0"
              class="plusIcon"
            >
              +
              <p-overlayPanel #op>
                <ul
                  style="list-style-type: none"
                  *ngFor="
                    let skill of remainaingSkills(
                      rowData.Skill,
                      getFormattedSkills(rowData.Skill).remainingCount
                    )
                  "
                >
                  <li>
                    <p-chip class="scheduleChip" label="{{ skill }}"></p-chip>
                  </li>
                </ul>
              </p-overlayPanel>
              <p-badge
                class="cursor-design"
                (click)="op.toggle($event)"
                [value]="
                  getFormattedSkills(rowData.Skill).remainingCount.toString()
                "
              ></p-badge>
            </span>
          </td>
          <!--skill end-->

          <td>
            <div
              class="icons-td flex align-items-center justify-content-between cursor-pointer"
            >
              <!--Edit icon-->
              <!-- <div class="cursor-pointer"> -->
              <a
                class="flex"
                (click)="handleEditIconClick(rowData.id)"
                [class.disabled]="!rowData.isEdit"
                title="Edit"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 18 18"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M3.375 14.625H4.2L12.5062 6.31877L11.6812 5.49377L3.375 13.8V14.625ZM14.8875 5.51252L12.4875 3.11252L13.275 2.32502C13.4875 2.11252 13.7531 2.0094 14.0719 2.01565C14.3906 2.0219 14.6563 2.13127 14.8688 2.34377L15.675 3.15002C15.8875 3.36252 15.9938 3.62502 15.9938 3.93752C15.9938 4.25002 15.8875 4.51252 15.675 4.72502L14.8875 5.51252ZM2.8125 15.75C2.65 15.75 2.51563 15.6969 2.40938 15.5906C2.30313 15.4844 2.25 15.35 2.25 15.1875V13.575C2.25 13.5 2.2625 13.4313 2.2875 13.3688C2.3125 13.3063 2.35625 13.2438 2.41875 13.1813L11.7 3.90002L14.1 6.30002L4.81875 15.5813C4.75625 15.6438 4.69375 15.6875 4.63125 15.7125C4.56875 15.7375 4.5 15.75 4.425 15.75H2.8125ZM12.0938 5.90627L11.6812 5.49377L12.5062 6.31877L12.0938 5.90627Z"
                    fill="#652D90"
                  />
                </svg>
              </a>
              <!-- </div> -->

              <!--View Icon-->
              <!-- <div class="mr-3 cursor-pointer"> -->
              <a
                class="flex cursor-pointer"
                [class.disabled]="!rowData.isMail"
                title="View"
                (click)="onViewClick(rowData.id)"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 18 18"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.99998 11.8125C9.88748 11.8125 10.6406 11.5031 11.2593 10.8844C11.8781 10.2656 12.1875 9.5125 12.1875 8.625C12.1875 7.7375 11.8781 6.98438 11.2593 6.36563C10.6406 5.74688 9.88748 5.4375 8.99998 5.4375C8.11248 5.4375 7.35935 5.74688 6.7406 6.36563C6.12185 6.98438 5.81248 7.7375 5.81248 8.625C5.81248 9.5125 6.12185 10.2656 6.7406 10.8844C7.35935 11.5031 8.11248 11.8125 8.99998 11.8125ZM8.99998 10.725C8.41248 10.725 7.9156 10.5219 7.50935 10.1156C7.1031 9.70937 6.89998 9.2125 6.89998 8.625C6.89998 8.0375 7.1031 7.54063 7.50935 7.13437C7.9156 6.72812 8.41248 6.525 8.99998 6.525C9.58748 6.525 10.0844 6.72812 10.4906 7.13437C10.8969 7.54063 11.1 8.0375 11.1 8.625C11.1 9.2125 10.8969 9.70937 10.4906 10.1156C10.0844 10.5219 9.58748 10.725 8.99998 10.725ZM8.99998 14.25C7.27498 14.25 5.7031 13.7812 4.28435 12.8438C2.8656 11.9062 1.76873 10.6688 0.993726 9.13125C0.956226 9.06875 0.928101 8.99375 0.909351 8.90625C0.890601 8.81875 0.881226 8.725 0.881226 8.625C0.881226 8.525 0.890601 8.43125 0.909351 8.34375C0.928101 8.25625 0.956226 8.18125 0.993726 8.11875C1.76873 6.58125 2.8656 5.34375 4.28435 4.40625C5.7031 3.46875 7.27498 3 8.99998 3C10.725 3 12.2969 3.46875 13.7156 4.40625C15.1344 5.34375 16.2312 6.58125 17.0062 8.11875C17.0437 8.18125 17.0719 8.25625 17.0906 8.34375C17.1094 8.43125 17.1187 8.525 17.1187 8.625C17.1187 8.725 17.1094 8.81875 17.0906 8.90625C17.0719 8.99375 17.0437 9.06875 17.0062 9.13125C16.2312 10.6688 15.1344 11.9062 13.7156 12.8438C12.2969 13.7812 10.725 14.25 8.99998 14.25ZM8.99998 13.125C10.5125 13.125 11.9031 12.7156 13.1719 11.8969C14.4406 11.0781 15.4062 9.9875 16.0687 8.625C15.4062 7.2625 14.4406 6.17188 13.1719 5.35312C11.9031 4.53437 10.5125 4.125 8.99998 4.125C7.48748 4.125 6.09685 4.53437 4.8281 5.35312C3.55935 6.17188 2.58748 7.2625 1.91248 8.625C2.58748 9.9875 3.55935 11.0781 4.8281 11.8969C6.09685 12.7156 7.48748 13.125 8.99998 13.125Z"
                    fill="#652D90"
                  />
                </svg>
              </a>

              <!--add icon-->
              <a class="flex" title="Send Invite">
                <svg
                  width="18"
                  height="12"
                  viewBox="0 0 18 12"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  (click)="onSendQuestionClick(rowData.id)"
                  style="cursor: pointer"
                >
                  <path
                    d="M9.44709 5.73173C9.76632 5.38462 10.0024 4.98607 10.1553 4.53608C10.3081 4.08608 10.3846 3.62214 10.3846 3.14427C10.3846 2.66639 10.3081 2.20246 10.1553 1.75246C10.0024 1.30246 9.76632 0.9039 9.44709 0.556787C10.1057 0.63275 10.6526 0.917125 11.0877 1.40991C11.5228 1.90269 11.7403 2.48081 11.7403 3.14427C11.7403 3.80772 11.5228 4.38584 11.0877 4.87863C10.6526 5.37141 10.1057 5.65578 9.44709 5.73173ZM13.0947 11.4808C13.1889 11.3087 13.2608 11.1255 13.3103 10.9312C13.3598 10.737 13.3846 10.5404 13.3846 10.3414V9.72117C13.3846 9.31231 13.3014 8.92331 13.1351 8.55419C12.9687 8.18508 12.7327 7.86831 12.4269 7.60388C13.0019 7.79523 13.5312 8.05341 14.0149 8.37841C14.4985 8.70339 14.7403 9.15098 14.7403 9.72117V10.3414C14.7403 10.6577 14.6295 10.9267 14.4079 11.1483C14.1863 11.3699 13.9173 11.4808 13.6009 11.4808H13.0947ZM14.7403 5.06251H13.8028C13.6434 5.06251 13.5099 5.00858 13.4021 4.90073C13.2943 4.79287 13.2403 4.65922 13.2403 4.49978C13.2403 4.34033 13.2943 4.20676 13.4021 4.09908C13.5099 3.99139 13.6434 3.93754 13.8028 3.93754H14.7403V3.00003C14.7403 2.84065 14.7943 2.70706 14.9021 2.59924C15.01 2.49144 15.1436 2.43754 15.3031 2.43754C15.4625 2.43754 15.5961 2.49144 15.7038 2.59924C15.8115 2.70706 15.8653 2.84065 15.8653 3.00003V3.93754H16.8028C16.9622 3.93754 17.0958 3.99147 17.2036 4.09932C17.3114 4.20718 17.3653 4.34083 17.3653 4.50027C17.3653 4.65972 17.3114 4.79329 17.2036 4.90098C17.0958 5.00866 16.9622 5.06251 16.8028 5.06251H15.8653V6.00003C15.8653 6.1594 15.8114 6.29299 15.7035 6.40079C15.5957 6.5086 15.462 6.56251 15.3026 6.56251C15.1431 6.56251 15.0096 6.5086 14.9019 6.40079C14.7942 6.29299 14.7403 6.1594 14.7403 6.00003V5.06251ZM6.25961 5.76923C5.53774 5.76923 4.91978 5.51221 4.40572 4.99816C3.89167 4.48409 3.63464 3.86613 3.63464 3.14427C3.63464 2.42239 3.89167 1.80443 4.40572 1.29038C4.91978 0.776318 5.53774 0.519287 6.25961 0.519287C6.98148 0.519287 7.59944 0.776318 8.11349 1.29038C8.62756 1.80443 8.88459 2.42239 8.88459 3.14427C8.88459 3.86613 8.62756 4.48409 8.11349 4.99816C7.59944 5.51221 6.98148 5.76923 6.25961 5.76923ZM0.634644 10.3414V9.81348C0.634644 9.44618 0.7344 9.10604 0.933912 8.79306C1.13344 8.48009 1.40002 8.23946 1.73367 8.07119C2.47501 7.70773 3.22284 7.43513 3.97717 7.25341C4.73149 7.07168 5.49231 6.98082 6.25961 6.98082C7.02691 6.98082 7.78772 7.07168 8.54204 7.25341C9.29637 7.43513 10.0442 7.70773 10.7856 8.07119C11.1192 8.23946 11.3858 8.48009 11.5853 8.79306C11.7848 9.10604 11.8846 9.44618 11.8846 9.81348V10.3414C11.8846 10.6577 11.7738 10.9267 11.5521 11.1483C11.3305 11.3699 11.0615 11.4808 10.7452 11.4808H1.77402C1.45769 11.4808 1.18871 11.3699 0.967081 11.1483C0.745456 10.9267 0.634644 10.6577 0.634644 10.3414ZM6.25961 4.64427C6.67211 4.64427 7.02523 4.49739 7.31898 4.20364C7.61273 3.90989 7.75961 3.55677 7.75961 3.14427C7.75961 2.73177 7.61273 2.37864 7.31898 2.08489C7.02523 1.79114 6.67211 1.64427 6.25961 1.64427C5.84711 1.64427 5.49398 1.79114 5.20023 2.08489C4.90648 2.37864 4.75961 2.73177 4.75961 3.14427C4.75961 3.55677 4.90648 3.90989 5.20023 4.20364C5.49398 4.49739 5.84711 4.64427 6.25961 4.64427ZM1.75961 10.3558H10.7596V9.81348C10.7596 9.66155 10.7156 9.52093 10.6276 9.3916C10.5397 9.26228 10.4202 9.15674 10.2692 9.07501C9.62307 8.75675 8.96421 8.51564 8.29263 8.35169C7.62107 8.18775 6.94339 8.10578 6.25961 8.10578C5.57583 8.10578 4.89816 8.18775 4.22658 8.35169C3.55502 8.51564 2.89616 8.75675 2.24999 9.07501C2.09903 9.15674 1.97956 9.26228 1.89159 9.3916C1.8036 9.52093 1.75961 9.66155 1.75961 9.81348V10.3558Z"
                    fill="#652D90"
                  />
                </svg>
              </a>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5">No Data found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<div class="questionsidebar">
  <p-sidebar [(visible)]="viewQuestionSidebar" position="right" [modal]="false">
    <ng-template class="header_design" pTemplate="header"
      >Quiz Preview
    </ng-template>
    <ng-template pTemplate="content" *ngIf="FinalizedQuestions">
      <span *ngFor="let question of FinalizedQuestions; let j = index">
        <div class="question-design">{{ j + 1 }}. {{ question.question }}</div>

        <div class="select-size">
          <div
            *ngFor="let option of question.options; let i = index"
            class="option"
            [ngClass]="getSelectedOptions(question.answer, option)"
          >
            <input
              type="radio"
              [name]="'option_' + i"
              [id]="'option_' + i"
              [checked]="option === question.answer"
            />
            <label class="box-design" [for]="'option' + question + '-' + i">{{
              getLabel(i)
            }}</label>

            <span class="option-content">{{ option }}</span>
          </div>
        </div>
      </span>

      <div class="btnfooter">
        <div class="quiz-instruction">
          <p class="instruction">Quiz Instructions</p>
          <ul class="points">
            <li>Manager approval mandatory</li>
            <li>
              Automatic email will be triggered for every status change of the
              request
            </li>
            <li>Approval is the permission to go to Office</li>
          </ul>
        </div>
        <div class="sidebarbuttons">
          <div class="custom_button_send">
            <p-button label="Close" (onClick)="closeSidebar()"></p-button>
          </div>
        </div>
      </div>
    </ng-template>
  </p-sidebar>
</div>

<p-toast></p-toast>
<div class="sendinvite">
  <p-dialog
    [visible]="sendQuestionCardVisible"
    [modal]="true"
    [style]="{ width: '47VW' }"
    header="Send Invite"
    [closable]="false"
  >
    <div class="wholedialog">
      <div class="dialogcontent">
        <p-multiSelect
          [options]="candidateData"
          optionLabel="candidateName"
          [(ngModel)]="selectedCandidates"
          placeholder="Select Candidate"
          [filter]="true"
          appendTo="body"
          display="chip"
          [showClear]="false"
          (onChange)="selectingCandidate()"
        ></p-multiSelect>
      </div>
      <div class="btnfooter">
        <div class="custom_button">
          <p-button label="Cancel" (onClick)="closeInviteDialog()"></p-button>
        </div>
        <div class="custom_button_send">
          <p-button label="Send" (onClick)="inviteCandidate()"></p-button>
        </div>
      </div>
    </div>
  </p-dialog>
</div>

<div class="newSchedule-Dialog">
  <p-dialog
    header="New Schedule"
    [(visible)]="visible"
    [formGroup]="addnewScheduleForm"
    [modal]="true"
    [style]="{ width: '47VW' }"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="NewSchedule-content">
      <div class="labelvalue">
        <div class="label">
          <label>Schedule Name</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <input type="text" formControlName="scheduleName" pInputText />

          <div
            *ngIf="
              addnewScheduleForm.get('scheduleName')?.invalid &&
              (addnewScheduleForm.get('scheduleName')?.touched || formSubmitted)
            "
          >
            <div
              class="error-message"
              *ngIf="
                addnewScheduleForm.get('scheduleName')?.hasError('required')
              "
            >
              Schedule Name is required !
            </div>
          </div>
        </div>
      </div>

      <div class="labelvalue">
        <div class="label">
          <label>Manager</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <p-dropdown
            [options]="managerData"
            placeholder="--Select Manager--"
            formControlName="managerName"
            appendTo="body"
          ></p-dropdown>

          <div
            *ngIf="
              addnewScheduleForm.get('managerName')?.invalid &&
              (addnewScheduleForm.get('managerName')?.touched || formSubmitted)
            "
          >
            <div
              class="error-message"
              *ngIf="
                addnewScheduleForm.get('managerName')?.hasError('required')
              "
            >
              Manager Name is required !
            </div>
          </div>
        </div>
      </div>

      <div class="labelvalue">
        <div class="label">
          <label>Skills</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <p-multiSelect
            [options]="skillSet"
            placeholder="--Select Skill--"
            formControlName="skills"
            [filter]="true"
            appendTo="body"
            display="chip"
            [showClear]="false"
          ></p-multiSelect>

          <div
            *ngIf="
              addnewScheduleForm.get('skills')?.invalid &&
              (addnewScheduleForm.get('skills')?.touched || formSubmitted)
            "
          >
            <div
              class="error-message"
              *ngIf="addnewScheduleForm.get('skills')?.hasError('required')"
            >
              Skills is required !
            </div>
          </div>
        </div>
      </div>

      <div class="cuttoffDuration">
        <div class="labelvalue">
          <div class="label">
            <label>Cutoff (in %)</label>
            <span class="important-symbol">&#42;</span>
          </div>
          <div class="value">
            <input
              type="number"
              pInputText
              formControlName="cutoff"
              mode="decimal"
            />

            <div
              *ngIf="
                addnewScheduleForm.get('cutoff')?.invalid &&
                (addnewScheduleForm.get('cutoff')?.touched || formSubmitted)
              "
            >
              <div
                class="error-message"
                *ngIf="addnewScheduleForm.get('cutoff')?.hasError('required')"
              >
                cutoff is required !
              </div>
            </div>

            <div
              class="error-message"
              *ngIf="addnewScheduleForm.get('cutoff')?.hasError('max')"
            >
              cutoff must be less than 100!
            </div>

            <div
              class="error-message"
              *ngIf="addnewScheduleForm.get('cutoff')?.hasError('min')"
            >
              Cutoff value must be greater than 0 !
            </div>
          </div>
        </div>

        <div class="labelvalue">
          <div class="label">
            <label>Duration(minutes)</label>
            <span class="important-symbol">&#42;</span>
          </div>
          <div class="value">
            <input
              type="text"
              pInputText
              formControlName="duration"
              mode="decimal"
            />
            <div
              *ngIf="
                addnewScheduleForm.get('duration')?.invalid &&
                (addnewScheduleForm.get('duration')?.touched || formSubmitted)
              "
            >
              <div
                class="error-message"
                *ngIf="addnewScheduleForm.get('duration')?.hasError('required')"
              >
                duration is required !
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="Newschedule-button">
        <div class="Cancelbutton">
          <p-button label="Cancel" [outlined]="true" (onClick)="cancelButton()">
          </p-button>
        </div>
        <div class="Createbutton">
          <p-button label="Create" (onClick)="createButton()"> </p-button>
        </div>
      </div>
    </ng-template>
  </p-dialog>
</div>
