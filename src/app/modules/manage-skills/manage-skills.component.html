<div class="whole-design">
  <div class="assesment-header">
    <p class="assessment-text">Questions</p>
  </div>
  <div class="flex breadDate">
    <div>
      <p-breadcrumb
        class="BreadCrumb"
        [model]="items"
        [style]="{ border: 'none' }"
      ></p-breadcrumb>
    </div>
    <div class="date">
      {{ todayDate }}
    </div>
  </div>

  <div class="candidate-table">
    <div class="tabview-count">
      <div class="tabview">
        <p-tabView>
          <p-tabPanel *ngFor="let tab of tabs" [header]="tab.title">
            <!-- <ng-template pTemplate="header">
             
            </ng-template> -->
            <p-table
              #dt2
              class="newscheduleTable"
              [value]="tab.content"
              dataKey="id"
              [scrollable]="true"
              scrollHeight="270px"
              [globalFilterFields]="[
                'question',
                'questionType',
                'Difficulty_Level',
                'options'
              ]"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th colspan="6">
                    <div class="headerSearch">
                      <div class="searchbox">
                        <span class="p-input-icon-left searchicon">
                          <i class="pi pi-search"></i>
                          <input
                            pInputText
                            type="text"
                            placeholder="Search"
                            (input)="
                              dt2.filterGlobal(
                                $any($event.target).value,
                                'contains'
                              )
                            "
                          />
                        </span>
                      </div>

                      <div class="Createbutton">
                        <p-button
                          label="Preview"
                          icon="pi pi-eye"
                          (onClick)="onPreviewClick(tab.content)"
                        >
                        </p-button>
                      </div>

                      <div class="Createbutton">
                        <button
                          pButton
                          class="btn flex align-items-center justify-content-center cursor-pointer"
                          (click)="newQuestionAdd()"
                          label="Add Questions"
                        ></button>
                      </div>
                    </div>
                  </th>
                </tr>
              </ng-template>

              <ng-template pTemplate="body" let-rowData let-j="rowIndex">
                <tr class="customRow">
                  <td class="questiontext">
                    {{ j + 1 }}. {{ rowData.question }}
                  </td>
                  <td class="optiontext">{{ rowData.questionType }}</td>
                  <td class="optiontext">
                    {{ rowData.options.length }} Choices
                  </td>
                  <td class="optiontext">{{ rowData.Difficulty_Level }}</td>
                  <td>
                    <div class="editviewicons">
                      <div class="editIcon">
                        <svg
                          width="24"
                          height="18"
                          viewBox="0 0 18 18"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                          style="cursor: pointer"
                          (click)="
                            individualQuestionView(
                              rowData.id,
                              rowData.question,
                              rowData.questionType,
                              rowData.options,
                              rowData.skills,
                              rowData.Difficulty_Level,
                              rowData.answer
                            )
                          "
                        >
                          <path
                            d="M3.375 14.625H4.2L12.5062 6.31877L11.6812 5.49377L3.375 13.8V14.625ZM14.8875 5.51252L12.4875 3.11252L13.275 2.32502C13.4875 2.11252 13.7531 2.0094 14.0719 2.01565C14.3906 2.0219 14.6563 2.13127 14.8688 2.34377L15.675 3.15002C15.8875 3.36252 15.9938 3.62502 15.9938 3.93752C15.9938 4.25002 15.8875 4.51252 15.675 4.72502L14.8875 5.51252ZM2.8125 15.75C2.65 15.75 2.51563 15.6969 2.40938 15.5906C2.30313 15.4844 2.25 15.35 2.25 15.1875V13.575C2.25 13.5 2.2625 13.4313 2.2875 13.3688C2.3125 13.3063 2.35625 13.2438 2.41875 13.1813L11.7 3.90002L14.1 6.30002L4.81875 15.5813C4.75625 15.6438 4.69375 15.6875 4.63125 15.7125C4.56875 15.7375 4.5 15.75 4.425 15.75H2.8125ZM12.0938 5.90627L11.6812 5.49377L12.5062 6.31877L12.0938 5.90627Z"
                            fill="#652D90"
                          />
                        </svg>
                      </div>
                      <div
                        class="previewIcon"
                        (click)="questionPreview(rowData)"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          fill="#652d90"
                          x="0px"
                          y="0px"
                          width="20"
                          height="18"
                          viewBox="0 0 576 512"
                          style="cursor: pointer"
                        >
                          <path
                            d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"
                          />
                        </svg>
                      </div>
                    </div>
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-tabPanel>
        </p-tabView>
      </div>
    </div>
  </div>
</div>

<div class="questionsidebar">
  <p-sidebar
    [(visible)]="previewSidebarVisible"
    position="right"
    [modal]="false"
  >
    <ng-template class="header_design" pTemplate="header"
      >Quiz Preview
    </ng-template>
    <ng-template pTemplate="content" *ngIf="selectedquestions">
      <span *ngFor="let question of selectedquestions; let j = index">
        <div class="question-design">{{ j + 1 }}. {{ question.question }}</div>

        <div class="select-size">
          <div
            *ngFor="let option of question.options; let i = index"
            class="option"
            [ngClass]="getSelectedOptions(question.answer, option)"
          >
            <input
              type="radio"
              [name]="'option_' + i"
              [id]="'option_' + i"
              [checked]="option === question.answer"
            />
            <label class="box-design" [for]="'option' + question + '-' + i">{{
              getLabel(i)
            }}</label>

            <span class="option-content">{{ option }}</span>
          </div>
        </div>
      </span>

      <div class="btnfooter">
        <div class="quiz-instruction">
          <p class="instruction">Quiz Instructions</p>
          <ul class="points">
            <li>Manager approval mandatory</li>
            <li>
              Automatic email will be triggered for every status change of the
              request
            </li>
            <li>Approval is the permission to go to Office</li>
          </ul>
        </div>
        <div class="sidebarbuttons">
          <div class="custom_button_send">
            <p-button label="Close" (onClick)="sidebarClose()"></p-button>
          </div>
        </div>
      </div>
    </ng-template>
  </p-sidebar>
</div>

<div class="card flex justify-content-centre">
  <div class="newSchedule-Dialog">
    <p-dialog
      header="Upload Questions"
      [(visible)]="visible"
      [modal]="true"
      [style]="{ width: '47VW' }"
      [draggable]="false"
      [resizable]="false"
    >
      <div class="NewSchedule-content">
        <div class="quiz-instruction">
          <p class="instruction">Upload Question Instructions</p>
          <ul class="points">
            <li>Download the provided question template.</li>
            <li>Provide the correct value for each specific field.</li>
            <li>Do not alter the heading in any way.</li>
            <li>
              Specify the questionType field with values - either Radio or
              Checkbox.
            </li>
            <li>
              Specify the Difficulty type field with values - Easy, Medium, or
              Hard.
            </li>
            <li>
              If it is Radio type question, Give the exact correct answer in any one of the answer field.
            </li>
            <li>
              If it is Checkbox type question, Mention the correct answers in separate answer field.
            </li>
          </ul>
        </div>
      </div>

      <ng-template pTemplate="footer" class="Newschedule-button">
        <div class="Cancelbutton">
          <p-button label="Cancel" [outlined]="true" (onClick)="cancelButton()">
          </p-button>
        </div>

        

        <div class="Createbutton">
          <p-button label="Download" (onClick)="downloadQuestionsCsvTemplate()">
          </p-button>
        </div>

        <label class="custom-file-input">
          Upload File
          <input
            type="file"
            (change)="uploadCsv($event)"
            style="display: none"
          /> </label
        >`
      </ng-template>
    </p-dialog>
  </div>
</div>

<p-toast></p-toast>
<div class="newSchedule-Dialog">
  <p-dialog
    header="Edit Schedule"
    [(visible)]="QuestionView"
    [modal]="true"
    [style]="{ width: '47VW' }"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="NewSchedule-content">
      <div class="labelvalue">
        <div class="label">
          <label>Question</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <input type="text" pInputText [(ngModel)]="question" />
        </div>
      </div>

      <div class="labelvalue">
        <div class="label">
          <label>QuestionType</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <p-dropdown
            appendTo="body"
            class="w-full table_dropdown"
            placeholder="--Select--"
            [options]="questionType"
            [(ngModel)]="questionTypeSelected"
          >
          </p-dropdown>
        </div>
      </div>

      <div class="labelvalue">
        <div class="label">
          <label>Difficulty Level</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div class="value">
          <p-dropdown
            appendTo="body"
            class="w-full table_dropdown"
            placeholder="--Select--"
            [options]="difficultyLevel"
            [(ngModel)]="Difficulty_Level"
          >
          </p-dropdown>
        </div>
      </div>

      <div
        class="labelvalue"
        *ngIf="
          questionTypeSelected === 'Radio' ||
          questionTypeSelected === 'Checkbox'
        "
      >
        <div class="label">
          <label>Option</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div
          class="valueedit"
          *ngFor="let letter of ['A', 'B', 'C', 'D']; let i = index"
        >
          <label for="answer{{ i }}" class="title">{{ letter }} </label>
          <input type="text" pInputText [(ngModel)]="choices[i]" />
        </div>
      </div>

      <div
        class="labelvalue"
        *ngIf="
          questionTypeSelected === 'Radio' ||
          questionTypeSelected === 'Checkbox'
        "
      >
        <div class="label">
          <label>Answer</label>
          <span class="important-symbol">&#42;</span>
        </div>
        <div
          class="valueans"
          *ngFor="let letter of ['A', 'B', 'C', 'D']; let i = index"
        >
          <ng-container
            *ngIf="questionTypeSelected === 'Radio'; else checkboxBlock"
          >
            <p-radioButton
              [(ngModel)]="answer"
              [value]="choices[i]"
              required
            ></p-radioButton>
          </ng-container>
          <ng-template #checkboxBlock>
            <p-checkbox [(ngModel)]="answer" [value]="choices[i]"></p-checkbox>
          </ng-template>

          <label for="answer{{ i }}" class="title">{{ letter }}</label>
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="Update-button">
        <div class="Cancelbutton">
          <p-button [outlined]="true" (onClick)="cancelQuestionView()">
            <label class="cancel-word"> Cancel </label>
          </p-button>
        </div>
        <div class="Createbutton">
          <p-button (click)="updateQuestionView()" [disabled]="">
            <label class="Create-word"> Update </label>
          </p-button>
        </div>
      </div>
    </ng-template>
  </p-dialog>
</div>

<div class="questionPreview">
  <p-dialog
    header="Question Preview"
    [(visible)]="questionPreviewvisible"
    [modal]="true"
    [style]="{ width: '38.75rem', height: 'auto' }"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
    [draggable]="false"
  >
    <ng-template pTemplate="header">
      <div class="inline-flex align-items-center justify-content-center gap-2">
        <p class="questionpreviewtext">Question Preview</p>
      </div>
    </ng-template>
    <div class="questionpreviewcardbody">
      <div class="questionhead">
        {{ singleQuestion }}
      </div>
    </div>
    <div class="select-size">
      <div
        *ngFor="let option of singleQuestionOption; let i = index"
        class="option"
        [ngClass]="getSelectedOptions(singleQuestionAnswer, option)"
      >
        <input type="radio" [checked]="option === singleQuestionAnswer" />
        <label class="box-design">{{ getLabel(i) }}</label>

        <span class="option-content">{{ option }}</span>
      </div>
    </div>
    
  </p-dialog>
</div>
